<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Datei-Transfer</title>
    <style>
        /* Bisheriges Styling bleibt unverändert */
    </style>
</head>
<body>
    <!-- Bisheriger HTML-Inhalt bleibt gleich -->

    <script>
        document.getElementById('fileInput').addEventListener('change', function() {
            let file = this.files[0];
            if (!file) return;

            let formData = new FormData();
            formData.append("file", file);

            let xhr = new XMLHttpRequest();
            xhr.open("POST", "https://home-ujmu.onrender.com/upload", true);

            let startTime = Date.now();
            document.getElementById("progressContainer").style.display = "block";
            document.getElementById("warning").style.display = "block";

            xhr.upload.onprogress = function(event) {
                if (event.lengthComputable) {
                    let percentComplete = Math.round((event.loaded / event.total) * 100);
                    document.getElementById("progressFill").style.width = percentComplete + "%";
                    document.getElementById("progressText").textContent = "Hochladen: " + percentComplete + "%";

                    let elapsedTime = (Date.now() - startTime) / 1000;
                    let speed = event.loaded / elapsedTime;
                    let remainingTime = (event.total - event.loaded) / speed;

                    let minutes = Math.floor(remainingTime / 60);
                    let seconds = Math.floor(remainingTime % 60);

                    document.getElementById("timeLeft").textContent = `Verbleibende Zeit: ${minutes}m ${seconds}s`;

                    if (percentComplete === 100) {
                        document.getElementById("uploadAlmostDone").style.display = "block";
                    }
                }
            };

            xhr.onload = function() {
                if (xhr.status == 200) {
                    let response = JSON.parse(xhr.responseText);
                    let downloadURL = response.url;

                    // Link anzeigen
                    document.getElementById("progressContainer").style.display = "none";
                    document.getElementById("linkBox").style.display = "block";
                    
                    // Direkter Download-Link
                    let downloadLink = document.getElementById("downloadLink");
                    downloadLink.value = downloadURL;
                    downloadLink.onclick = function() {
                        // Trigger direkter Download
                        window.location.href = downloadURL;
                    };
                }
            };

            xhr.send(formData);
        });

        // Bisheriger Copy-Button-Code bleibt unverändert
    </script>

    <footer>
        <p>&copy; 2025 Raffael Bauer. Alle Rechte vorbehalten.</p>
        <p>
            <a href="https://raffaelbauer.github.io/Datenschutzerklaerung/">Datenschutzbestimmungen</a>
        </p>
    </footer>
</body>
</html>
